/*
 * WebSearch - jQuery UI Widget v1.1 minified
 *
 * Copyright 2010, Rob Garrison (aka Mottie/Fudgey)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *   jquery.ui.core.js
 *   jquery.ui.widget.js
 *   jquery.ui.button.js
 */

(function(f){var d,c,i,h,g,j,k,m;f.widget("ui.websearch",{options:{defaultSite:"Google",windowTarget:"_blank",windowOptions:"",tooltipClass:"tooltip",sortList:true,hidden:false,searchResult:null,websearch:{Bing:["ui-icon-bing","http://www.bing.com/search?q={s}"],Dictionary:["ui-icon-dictionary","http://dictionary.reference.com/browse/{s}"],Google:["ui-icon-google","http://www.google.com/search?q={s}"],Wikipedia:["ui-icon-wikipedia","http://en.wikipedia.org/w/index.php?search={s}"],"Wolfram Alpha":["ui-icon-wolfram", "http://www.wolframalpha.com/input/?i={s}"],Yahoo:["ui-icon-yahoo","http://search.yahoo.com/search?p={s}"]}},_create:function(){c=this.options;d=this;this.element.addClass("ui-websearch-input ui-widget-content ui-corner-left").wrap('<div class="ui-websearch ui-widget"/>').after('<button class="ui-websearch ui-state-default '+c.tooltipClass+'"><span class="ui-icon ui-icon-websearch"></span></button><button class="ui-state-default ui-corner-right '+c.tooltipClass+'"><span class="ui-icon ui-icon-websearch-popup ui-icon-triangle-1-s"></span></button><div class="ui-websearch-popup ui-widget ui-widget-content ui-helper-clearfix ui-corner-all ui-helper-hidden-accessible"></div>').bind("mouseup focusout", function(){d._popup(false)});i=this.element.closest(".ui-widget");g=i.find(".ui-websearch-popup").hide();h=i.find("button");h.button({text:false,icons:{primary:null}}).removeClass("ui-corner-all ui-button").bind("click",function(){if(f(this).is(".ui-websearch")){d._search();return false}d._popup(true);return false}).filter(":eq(1)").add(g).bind("keyup focusin",function(e){e.type=="focusin"&&d._popup(true);e.which==27&&d._popup(false)});var a,b=[];for(a in c.websearch)if(c.websearch[a][0]!==""){a== c.defaultSite&&d._setSearchSite(a);b.push('<a href="#" class="site ui-state-default" data-name="'+a+'"><span class="ui-icon ui-icon-websearch '+c.websearch[a][0]+'"></span>'+a+"</a>")}c.sortList&&b.sort();g.html(b.join(" ")||"No Search Engines Set").find(".site").click(function(){d._setSearchSite(f(this).attr("data-name"));d._popup(false);return false}).hover(function(){f(this).toggleClass("ui-state-highlight")}).keyup(function(e){e.which==40&&f(this).next().focus();e.which==38&&f(this).prev().focus()}); this.element.keyup(function(e){e.which===13&&d._search()});h.find(".ui-icon-websearch").bind("click",function(){d._search();return false});j=g.width();k=g.outerHeight();m=i.outerHeight();c.hidden&&i.hide()},_popup:function(a){if(!(a&&g.is(":visible")))if(a){var b=h.position();a=b.left+j<f(window).width()-50?b.left:f(window).width()-j-50;b=b.top-k<f(window).scrollTop()?b.top+m:b.top-k;g.css({left:a,top:b,width:j}).fadeIn("slow")}else g.fadeOut("slow")},_setSearchSite:function(a){if(typeof a==="undefined"|| a===""||!c.websearch.hasOwnProperty(a))return h.attr("title");var b=c.websearch[a];this.element.attr("data-search-string",b[1]||"").next().attr("title",a).find(".ui-icon-websearch").attr("class","ui-icon ui-icon-websearch "+b[0]||"");this.element.trigger("change",a);return a},_search:function(a,b,e){a=escape(a||this.element.val());var l=this.element.attr("data-search-string").replace(/\{s\}/g,a);l===""||a===""||(c.searchResult?c.searchResult.call(this.element,l):window.open(l,b||c.windowTarget,e|| c.windowOptions))},current:function(a){return typeof a==="undefined"||a===""?h.attr("title"):this._setSearchSite(a)},search:function(a,b,e){this._search(a,b,e)},destroy:function(){this.element.removeClass("ui-websearch-input ui-widget-content ui-corner-left").removeAttr("data-search-string").parent().find("button, .ui-websearch-popup").remove();this.element.unwrap();f.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);