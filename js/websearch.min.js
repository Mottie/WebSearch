/*
 * WebSearch - jQuery UI Widget minified
 *
 * Copyright 2010, Rob Garrison (aka Mottie/Fudgey)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *   jquery.ui.core.js
 *   jquery.ui.widget.js
 *   jquery.ui.button.js
 */
 
(function(g){var d,j,h,e;g.widget("ui.websearch",{options:{defaultSite:"Google",openNewWindow:true,clicktoSearch:true,clickMessage:["(left click to search, right click to switch)","(press enter to search, click here to change)"],tooltipClass:"tooltip",sortList:true,hidden:false,websearch:{Bing:["ui-icon-bing","http://www.bing.com/search?q={s}"],Dictionary:["ui-icon-dictionary","http://dictionary.reference.com/browse/{s}"],Google:["ui-icon-google","http://www.google.com/search?q={s}"],Wikipedia:["ui-icon-wikipedia", "http://en.wikipedia.org/w/index.php?search={s}"],"Wolfram Alpha":["ui-icon-wolfram","http://www.wolframalpha.com/input/?i={s}"],Yahoo:["ui-icon-yahoo","http://search.yahoo.com/search?p={s}"]}},_create:function(){d=this.options;var a=this,b=d.clicktoSearch?"click contextmenu":"click";this.element.addClass("ui-websearch-input ui-widget-content ui-corner-left").wrap('<div class="ui-websearch ui-widget"/>').after('<button class="ui-state-default ui-corner-right '+d.tooltipClass+'"><span class="ui-icon ui-icon-websearch"></span></button><div class="ui-websearch-popup ui-widget ui-widget-content ui-helper-clearfix ui-corner-all ui-helper-hidden-accessible"></div>').bind("mouseup", function(){a._popup(false)});j=this.element.closest(".ui-widget");e=j.find(".ui-websearch-popup").hide();h=j.find("button");h.button({icons:{primary:null}}).removeClass("ui-corner-all").bind(b,function(c){if(e.is(":visible"))e.fadeOut("slow");else if(d.clicktoSearch&&c.which==1)a._search();else{c=e.width()||400;var k=e.height(),l=a.element.outerHeight(),i=h.position(),m=i.left+c<g(window).width()-50?i.left:g(window).width()-c-50;k=i.top-k<g(window).scrollTop()?i.top+l:i.top-k;e.css({left:m,top:k, width:c}).fadeIn("slow");return false}}).bind("keyup",function(c){if(c.which==38||c.which==40)a._popup(true);c.which==27&&a._popup(false)});var f;b=[];for(f in d.websearch)if(d.websearch[f][0]!==""){f==d.defaultSite&&a._setSearchSite(f);b.push('<a href="#" class="site ui-state-default" data-name="'+f+'"><span class="ui-icon ui-icon-websearch '+d.websearch[f][0]+'"></span>'+f+"</a>")}d.sortList&&b.sort();e.html(b.join(" ")||"No Search Engines Set").find(".site").click(function(){a._setSearchSite(g(this).attr("data-name")); a._popup(false);return false}).hover(function(){g(this).toggleClass("ui-state-highlight")});this.element.keyup(function(c){c.which===13&&a._search()});d.hidden&&j.hide()},_popup:function(a){if(a){a=e.width()||400;var b=h.position().left;b=b+a<g(window).width()-50?b:g(window).width()-a-50;e.css({left:b,width:a}).fadeIn("slow")}else e.fadeOut("slow")},_setSearchSite:function(a){if(!(typeof a==="undefined"||a===""||!this.options.websearch.hasOwnProperty(a))){var b=this.options,f=this.options.websearch[a]; this.element.attr("data-search-string",f[1]||"").next().attr("title",a+": "+(b.clicktoSearch?b.clickMessage[0]:b.clickMessage[1]||"")).find("span.ui-icon").attr("class","ui-icon ui-icon-websearch "+f[0]||"");this.element.trigger("change",a);return a}},_search:function(){var a=escape(this.element.val()),b=this.element.attr("data-search-string").replace(/\{s\}/g,a);if(!(b===""||a===""))if(this.options.openNewWindow)window.open(b,"_newtab");else document.location.href=b},current:function(a){return typeof a=== "undefined"||a===""?h.attr("title").split(":")[0]:this._setSearchSite(a)},destroy:function(){this.element.removeClass("ui-websearch-input ui-widget-content ui-corner-left").removeAttr("data-search-string").parent().find("button, .ui-websearch-popup").remove();this.element.unwrap();g.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);